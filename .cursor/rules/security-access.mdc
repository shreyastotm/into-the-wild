---
description: "Security, Authentication, and Data Protection Standards"
globs: ["src/**/*.{ts,tsx}", "supabase/**/*.{sql}", "backend/**/*.{ts,js}"]
alwaysApply: true
---

# ðŸ”’ SECURITY & ACCESS CONTROL RULES

## 4.1 Row Level Security (RLS)
âœ… **REQUIRED:** All database tables must have RLS policies
âœ… **REQUIRED:** Proper user authentication checks on all queries
âœ… **REQUIRED:** Role-based access control (trekker, admin, partner)
âœ… **REQUIRED:** Data isolation between users and treks

## 4.2 Authentication Standards
âœ… **REQUIRED:** Multi-factor authentication for admin accounts
âœ… **REQUIRED:** Secure password policies (minimum 8 characters, complexity)
âœ… **REQUIRED:** Session management with proper expiration
âœ… **REQUIRED:** Protected routes with authentication checks

## 4.3 Data Protection
âœ… **REQUIRED:** Encrypt sensitive data (ID proofs, payment info)
âœ… **REQUIRED:** GDPR compliance for user data handling
âœ… **REQUIRED:** Data backup and recovery procedures
âœ… **REQUIRED:** Audit logging for admin actions

## 4.4 API Security
âœ… **REQUIRED:** Input validation and sanitization on all endpoints
âœ… **REQUIRED:** Rate limiting on API calls
âœ… **REQUIRED:** CORS configuration for frontend access only
âœ… **REQUIRED:** Error messages must not expose system details